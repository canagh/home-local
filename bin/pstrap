#!/bin/sh

wait=1s # for sleep(1)

# option
while [ "$1" ] ; do
    case $1 in
        -h | --help ) echo $(basename "$0")' [-w|--wait] [--] PID...' ; exit ;;
        -w ) wait="$2" ; shift 2 ;;
        -- ) shift ; break ;;
        -* ) $(basename "$0")': unknown option: '"$1" >&2 ; exit 1 ;;
        * ) break ;;
    esac
done

if [ $# -eq 0 ] ; then
    echo $(basename "$0")': missing argument' >&2
    exit 1
fi

for arg in "$@"; do
    if echo "$arg" | grep -v '^[[:digit:]]\+$' >/dev/null 2>&1; then
        echo $(basename "$0")': wrong argument (a PID required): '"$arg" >&2
        exit 1
    fi
done

ps "$@" >/dev/null 2>&1
while [ $? -eq 0 ] ; do
    # ps returns exit code 1, when all processes are nothing
    sleep "$wait"
    ps "$@" >/dev/null 2>&1
done
exit 0 # breaking while, exit code is 1
