#!/bin/sh

while [ -n "$1" ] ; do
    case "$1" in
        -h | --help )
            echo 'Usage :'`basename "$0"`' [-h|--help] [--directory DIR] [--] [OPTIONS..]'
            echo 'Run the executable which the directory has only.'
            echo 'If the directory has two or more executables, exit without execution.'
            exit
            ;;
        --directory )
            dir="$2"
            shift 2
            ;;
        -- )
            shift
            break
            ;;
        * )
            break
            ;;
    esac
done
bins=`find "${dir:-.}" -maxdepth 1 -type f -executable`
case `echo "$bins" | wc -l` in
    0 )
        echo 'runit: never come here' >&2
        exit 1
        ;;
    1 )
        if [ -z "$bins" ] ; then
            echo 'runit: executable not found' >&2
            exit 1
        else
            exec "$bins" "$@"
        fi
        ;;
    * )
        echo 'runit: too many executables found' >&2
        exit 1
        ;;
esac
