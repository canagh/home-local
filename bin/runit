#!/bin/sh

while [ -n "$1" ] ; do
    case "$1" in
        -h | --help )
            echo 'runit [-h|--help] [--directory DIR] [--] [OPTIONS..]'
            exit 0
            ;;
        --directory )
            dir="$2"
            shift 2
            ;;
        -- )
            shift
            break
            ;;
        * )
            break
            ;;
    esac
done
bins=`find "${dir:-.}" -maxdepth 1 -type f -executable`
case `echo "$bins" | wc -l` in
    0 )
        echo 'runit: never come here' >&2
        exit 1
        ;;
    1 )
        if [ -z "$bins" ] ; then
            echo 'runit: executable not found' >&2
            exit 1
        else
            exec "$bins" "$@"
        fi
        ;;
    * )
        echo 'runit: too many executables found' >&2
        exit 1
        ;;
esac
