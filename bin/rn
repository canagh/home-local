#!/bin/sh

help() {
    echo Usage: `basename "$0"` SOURCE DEST...
}
error() {
    echo `basename "$0"`: $@ >&2
}

OPTS=$(getopt -n "$(basename $0)" -o h\? -l help -- "$@")
[ $? -ne 0 ] && exit 1
eval set -- "$OPTS"

while [ "$1" != -- ] ; do
    case "$1" in
        -h | -\? | --help ) help ; exit ;;
        -- ) break ;;
        * ) error unknown argument: "$1" ; exit 1 ;;
    esac
    shift
done
shift

if [ $# -lt 2 ] ; then
    help >&2
    exit 1
fi
src="$1"
shift

dir="`dirname "$src"`"

# -T, --no-target-directory -- treat DEST as a normal file
while [ $# != 1 ] ; do
    cp -T "$src" "$dir"/"$1"
done
mv -T "$src" "$dir"/"$1"
